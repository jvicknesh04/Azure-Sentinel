{
  "name": "carbonBlackViaAWSS3",
  "apiVersion": "2022-10-01-preview",
  "type": "Microsoft.SecurityInsights/dataConnectors",
  "kind": "AmazonWebServicesS3",
  "properties": {
      "connectorDefinitionName": "[[parameters('connectorDefinitionName')]",
      "dataTypes": {
          "logs": {
              "state": "enabled"
          }
      },
      "dcrConfig": {
          "streamName": "[[parameters('streamName')[0]]",
          "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
          "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
      },
      "roleArn": "[[parameters('roleArn')]",
      "sqsUrls": [
          "[[parameters('queueUrl')]"
      ],
      "destinationTable": "[[concat(parameters('streamName')[0],'_CL')]",
      "dataFormat": {
          "Format": "JsonLine",
          "IsCompressed": true,
          "compressType": "Gzip"
      }
  }
}